<!DOCTYPE html><html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ุจุฑุง ุงูุณุงููุฉ ุจุณ ูุง ุฃุฏุฑู โ ูุนุจุฉ ุญููุงุช</title>
  <style>
    :root{
      --bg:#0e1013;--card:#151922;--muted:#8b93a7;--text:#e9eef7;--accent:#6ee7b7;--accent2:#60a5fa;--danger:#f87171;--warn:#fbbf24;
    }
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,#0b0e12,#10131a 40%,#0b0e12);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif}
    .container{max-width:980px;margin:0 auto;padding:20px}
    h1,h2,h3{margin:0 0 12px}
    h1{font-size:28px}
    h2{font-size:22px}
    p{color:var(--muted)}
    .card{background:var(--card);border:1px solid #1f2531;border-radius:16px;padding:16px;margin:12px 0;box-shadow:0 10px 24px rgba(0,0,0,.25)}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    .col{flex:1 1 240px}
    label{display:block;margin-bottom:6px;color:#c6d3eb;font-size:14px}
    input,select,textarea,button{width:100%;padding:12px 14px;border-radius:12px;border:1px solid #263044;background:#0f1420;color:var(--text);outline:none}
    input:focus,select:focus,textarea:focus{border-color:var(--accent2)}
    button{cursor:pointer;background:linear-gradient(135deg,var(--accent2),#7dd3fc);border:none;font-weight:700}
    button.secondary{background:#1b2334;border:1px solid #2a3550}
    button.ghost{background:transparent;border:1px dashed #33415f}
    button.danger{background:linear-gradient(135deg,#ef4444,#fb7185)}
    .badge{display:inline-block;padding:4px 10px;border-radius:999px;background:#1d283a;border:1px solid #2a3550;color:#cfe0ff;font-size:12px}
    .list{display:flex;gap:8px;flex-wrap:wrap}
    .pill{padding:8px 12px;border-radius:999px;border:1px solid #2a3550;background:#131a28}
    .hidden{display:none}
    .center{text-align:center}
    .grid{display:grid;gap:10px}
    .grid-2{grid-template-columns:repeat(2,minmax(0,1fr))}
    .grid-3{grid-template-columns:repeat(3,minmax(0,1fr))}
    .muted{color:var(--muted)}
    .title{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
    .title .logo{width:38px;height:38px;display:grid;place-items:center;border-radius:12px;background:linear-gradient(135deg,var(--accent2),#34d399);font-weight:900}
    .hr{height:1px;background:#222a39;margin:14px 0}
    .footer{opacity:.7;font-size:12px}
    .big{font-size:20px}
    .word-flash{font-weight:800;font-size:34px;letter-spacing:1px;background:linear-gradient(90deg,#93c5fd,#34d399);-webkit-background-clip:text;background-clip:text;color:transparent}
    .stack{display:flex;flex-direction:column;gap:10px}
    .vote-item{display:flex;align-items:center;gap:8px}
    .score{display:flex;align-items:center;justify-content:space-between;padding:10px;border:1px solid #2a3550;border-radius:12px;background:#121828}
    .kbd{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;background:#0d1220;border:1px solid #2a3550;border-bottom-width:3px;border-radius:8px;padding:3px 6px}
  </style>
</head>
<body>
  <div class="container">
    <div class="title">
      <div class="logo">๐ต๏ธ</div>
      <div>
        <h1>ุจุฑุง ุงูุณุงููุฉ.. ุจุณ ูุง ุฃุฏุฑู!</h1>
        <p class="muted">ูุนุจุฉ ุญููุงุช ุงุฌุชูุงุนูุฉ: ูุงุญุฏ ูุฎุชูู ุนู ุงูุจููุฉ โ ููุง ูุฏุฑู ุฅูู ูุฎุชูู ๐</p>
      </div>
    </div><!-- SETUP CARD -->
<div id="view-setup" class="card">
  <h2>ุฅุนุฏุงุฏ ุงูุฌููุฉ</h2>
  <div class="row">
    <div class="col">
      <label>ุฃุณูุงุก ุงููุงุนุจูู (ุงูุตู ุจูููู ุจูุงุตูุฉ ุ)</label>
      <input id="playersInput" placeholder="ูุซุงู: ูุงุตุฑุ ุดูุฏุ ููุตูุ ุฑููุ ููุณู">
    </div>
    <div class="col">
      <label>ุนุฏุฏ ุงูุฃุณุฆูุฉ ูุจู ุงูุชุตููุช</label>
      <select id="questionCount">
        <option value="4">4</option>
        <option value="6" selected>6</option>
        <option value="8">8</option>
      </select>
    </div>
  </div>

  <div class="hr"></div>
  <div class="row">
    <div class="col">
      <label>ุงุฎุชูุงุฑ ุงูุชุตููู</label>
      <select id="categorySelect"></select>
    </div>
    <div class="col">
      <label>ุทุฑููุฉ ุงูุงุฎุชูุงุฑ</label>
      <select id="pairMode">
        <option value="random" selected>ุนุดูุงุฆู ูู ุงูุชุตููู</option>
        <option value="manual">ุงุฎุชูุงุฑ ูุฏูู ูููููุฉ/ุงููููุฉ ุงููุฎุชููุฉ</option>
      </select>
    </div>
  </div>

  <div id="manualPairs" class="row hidden">
    <div class="col">
      <label>ุงููููุฉ ุงูุฃุณุงุณูุฉ (ููุฃุบูุจูุฉ)</label>
      <input id="baseWord" placeholder="ูุซุงู: ูููุฉ">
    </div>
    <div class="col">
      <label>ูููุฉ ุงููุฎุชูู (ูุฑูุจุฉ ูู ุงูุฃุณุงุณูุฉ)</label>
      <input id="oddWord" placeholder="ูุซุงู: ุดุงู">
    </div>
  </div>

  <div class="hr"></div>
  <div class="row">
    <div class="col">
      <button id="startBtn">ุงุจุฏุฃ ุงูุฌููุฉ</button>
    </div>
    <div class="col">
      <button class="secondary" id="demoBtn">ุชุฌุฑุจุฉ ุณุฑูุนุฉ (ุฃุณูุงุก ููููุฉ)</button>
    </div>
  </div>

  <p class="footer">ูุตูุญุฉ: ุงุฌูุณูุง ูุฑูุจ ูู ุจุนุถ ูุชุจุงุฏููุง ุงูุฌูุงุฒ ูู ูุฑุญูุฉ โุนุฑุถ ุงููููุฉโ. ูุง ุฃุญุฏ ูุชุฌุณุณ ๐</p>
</div>

<!-- REVEAL CARD -->
<div id="view-reveal" class="card hidden">
  <h2>ุนุฑุถ ุงููููุฉ ููู ูุงุนุจ</h2>
  <p class="muted">ูุฑุฑ ุงูุฌูุงุฒ ููู ูุงุนุจ ุจุงูุชุฑุชูุจ ูุงุถุบุท ุนูู ุงุณูู ููุดูู ุงููููุฉ ูุซูุงูู.</p>
  <div id="revealList" class="grid grid-2"></div>
  <div class="hr"></div>
  <div class="row">
    <button class="secondary" id="backToSetup">ุฑุฌูุน</button>
    <button id="beginQuestions">ุงุจุฏุฃ ุงูุฃุณุฆูุฉ ุงูุนุดูุงุฆูุฉ</button>
  </div>
</div>

<!-- QUESTIONS CARD -->
<div id="view-questions" class="card hidden">
  <div class="row" style="align-items:center;justify-content:space-between">
    <h2>ุฌููุฉ ุงูุฃุณุฆูุฉ <span class="badge" id="qProgress">0/0</span></h2>
    <div class="badge" id="currentCategory">ุชุตููู</div>
  </div>
  <div class="hr"></div>
  <div class="grid">
    <div class="card" style="background:#101625;border-color:#222c44">
      <div class="big">ุณุคุงู:</div>
      <div id="questionText" class="word-flash" style="margin:6px 0 10px">โฆ</div>
      <div class="muted">ุงูุฏูุฑ ุงูุขู ุนูู: <span id="turnName" class="badge"></span></div>
    </div>
    <div class="row">
      <button id="nextQuestion">ุงูุณุคุงู ุงูุชุงูู</button>
      <button class="secondary" id="goVote">ุงูุชูุงู ููุชุตููุช</button>
    </div>
  </div>
  <p class="footer">ุชูููุญ: ุงุณุฃููุง ุฃุณุฆูุฉ ุชูุดู ุงููุฑููุงุช ุงูุฏูููุฉ. ูุซุงู: โูู ุชุชูุฏู ุญููุฉ ุฃู ูุงูุญุฉุโ</p>
</div>

<!-- VOTE CARD -->
<div id="view-vote" class="card hidden">
  <h2>ุงูุชุตููุช: ููู ุจุฑุง ุงูุณุงููุฉุ</h2>
  <div id="voteArea" class="stack"></div>
  <div class="hr"></div>
  <div class="row">
    <button class="secondary" id="backToQuestions">ุฑุฌูุน ููุฃุณุฆูุฉ</button>
    <button id="submitVotes">ุงุนุชูุงุฏ ุงูุชุตููุช</button>
  </div>
</div>

<!-- RESULT CARD -->
<div id="view-result" class="card hidden">
  <h2>ุงููุชูุฌุฉ</h2>
  <div id="resultSummary" class="grid"></div>
  <div class="hr"></div>
  <div class="row">
    <button class="ghost" id="newRoundSame">ุฌููุฉ ุฌุฏูุฏุฉ (ููุณ ุงููุงุนุจูู)</button>
    <button id="newRoundReset">ุฅุนุฏุงุฏ ุฌุฏูุฏ</button>
  </div>
</div>

<!-- SCOREBOARD -->
<div id="view-score" class="card hidden">
  <h2>ุงููุชุงุฆุฌ ุงููุชุฑุงููุฉ</h2>
  <div id="scoreList" class="stack"></div>
</div>

  </div>  <script>
  // ===== Data Packs (ุชุตูููุงุช + ุฃุฒูุงุฌ ูููุงุช ูุฑูุจุฉ) =====
  const PACKS = {
    "ุฃููุงุช ููุดุฑูุจุงุช": [
      ["ุจูุชุฒุง","ุจุฑุฌุฑ"],["ุดุงูุฑูุง","ูุงููุชุง"],["ูููุฉ","ุดุงู"],["ุนุตูุฑ ุจุฑุชูุงู","ุนุตูุฑ ูุงูุฌู"],["ูุงุจุชุดููู","ูุงุชูู"],["ุฑุฒ","ููุฑููุฉ"],["ูุทูุฑ","ุนุดุงุก"],["ูุนู","ุฏููุงุช"],["ูุงุก ุบุงุฒู","ุนุตูุฑ ุบุงุฒู"],["ููู","ุญูุต"]
    ],
    "ุฃูุงูู ููุฏู": [
      ["ุจุงุฑูุณ","ููุฏู"],["ููุฉ","ุงููุฏููุฉ"],["ุทูููู","ุณูู"],["ุงูุจุญุฑ ุงูุฃุญูุฑ","ุงูุฎููุฌ ุงูุนุฑุจู"],["ุงูุฑูุงุถ","ุฌุฏุฉ"],["ุงููุฑู","ุฃุจู ุงูููู"],["ุงูุตุญุฑุงุก","ุงููุงุญุฉ"],["ุดุงุทุฆ","ูุณุจุญ"],["ุฌุงูุนุฉ","ูุฏุฑุณุฉ"],["ูุณุชุดูู","ุนูุงุฏุฉ"]
    ],
    "ุฃุดูุงุก ููููุฉ": [
      ["ุฌูุงู","ุชุงุจูุช"],["ูููู","ูุฑูุญุฉ"],["ููู","ูุงุฑูุฑ"],["ูุฑุณู","ุฃุฑููุฉ"],["ุฑูููุช","ูุฏ ุชุญูู"],["ุณูุงุนุงุช","ุณุจููุฑ"],["ุญุงุณูุจ ูุญููู","ุญุงุณูุจ ููุชุจู"],["ูุตุจุงุญ","ุดูุนุฉ"],["ุณุงุนุฉ ูุฏ","ุณูุงุฑ ุฐูู"],["ุฏุฑุงุฌุฉ","ุณููุชุฑ"]
    ],
    "ุชูููููุฌูุง/ููุงููู": [
      ["ุฐูุงุก ุงุตุทูุงุนู","ุชุนูู ุขูู"],["ุฐุงูุฑุฉ","ุชุฎุฒูู"],["ูุงู ูุงู","ุจููุชูุซ"],["ุชุทุจูู","ูููุน"],["ุชุดููุฑ","ูููุงุช ูุฑูุฑ"],["ุฑูุจูุช","ุทุงุจุนุฉ ุซูุงุซูุฉ ุงูุฃุจุนุงุฏ"],["ูุธุงู ุฃูุฏุฑููุฏ","iOS"],["ูุงูุน ุงูุชุฑุงุถู","ูุงูุน ูุนุฒุฒ"],["ุณุญุงุจุฉ","ุณูุฑูุฑ"],["ููุญุฉ ููุงุชูุญ","ูุฃุฑุฉ"]
    ],
    "ูุดุงุนุฑ ูููุงููู": [
      ["ูุฑุญ","ุญูุงุณ"],["ุญุฒู","ุฅุญุจุงุท"],["ุฎูู","ููู"],["ุซูุฉ","ุบุฑูุฑ"],["ุตุฏู","ูุฌุงููุฉ"],["ุญุธ","ุงุฌุชูุงุฏ"],["ูุฏูุก","ุณูููุฉ"],["ุบุถุจ","ุงููุนุงู"],["ุญุจ","ุฅุนุฌุงุจ"],["ููู","ูุณู"]
    ]
  };

  const QUESTIONS = [
    "ูู ููุณุชุฎุฏู ุบุงูุจูุง ูู ุงูุตุจุงุญุ",
    "ูู ูู ุญูู ุนุงุฏุฉูุ",
    "ูู ููุคูู/ููุดุฑุจ ุณุงุฎููุงุ",
    "ูู ูููู ุบุงููุ",
    "ูู ุชุฌุฏู ุบุงูุจูุง ูู ุงูููุฒูุ",
    "ูู ููุณุชุฎุฏู ุจุงููุฏ ูุจุงุดุฑุฉุ",
    "ูู ูู ูุฑุชุจุท ุจููุงู ูุญุฏุฏุ",
    "ูู ููุตุฏุฑ ุตูุชูุงุ",
    "ูู ุญุฌูู ุนุงุฏุฉ ุตุบูุฑุ",
    "ูู ููุจุงุน ุบุงูุจูุง ูู ุงููุชุงุฌุฑ ุงููุชุฎุตุตุฉุ",
    "ูู ุชุญุชุงุฌ ููุฑุจุงุก ูุชุณุชุนูููุ",
    "ูู ูู ุดูุก ูููู ุญููู ูุนูุ",
    "ูู ููุนุชุจุฑ ุตุญููุง ุบุงูุจูุงุ",
    "ูู ููุณุชุฎุฏู ูู ุงูููุงุณุจุงุชุ",
    "ูู ูู ุฑุงุฆุญุฉ ูููุฒุฉุ"
  ];

  // ===== State =====
  let state = {
    players: [],
    scores: {},
    category: null,
    pair: null, // {base, odd}
    oddIndex: null,
    reveals: {},
    turnOrder: [],
    asked: 0,
    maxQuestions: 6,
    usedQuestions: new Set(),
    votes: {},
  };

  // ===== Helpers =====
  const $ = sel => document.querySelector(sel);
  const el = (tag, cls, html) => {const e=document.createElement(tag); if(cls) e.className=cls; if(html!==undefined) e.innerHTML=html; return e;};
  const shuffle = (arr)=>arr.map(v=>[Math.random(),v]).sort((a,b)=>a[0]-b[0]).map(x=>x[1]);
  const choice = (arr)=>arr[Math.floor(Math.random()*arr.length)];

  function saveScores(){ localStorage.setItem("bsb_scores", JSON.stringify(state.scores)); }
  function loadScores(){ const s=localStorage.getItem("bsb_scores"); if(s) state.scores = JSON.parse(s); }
  function renderScores(){ const box = $("#scoreList"); box.innerHTML=''; const items = Object.entries(state.scores).sort((a,b)=>b[1]-a[1]); items.forEach(([name,pts])=>{ box.appendChild(el('div','score',`<strong>${name}</strong><span>${pts} ููุทุฉ</span>`)); }); $("#view-score").classList.toggle('hidden', items.length===0); }

  function setView(id){ ["#view-setup","#view-reveal","#view-questions","#view-vote","#view-result"].forEach(s=>$(s).classList.add('hidden')); $(id).classList.remove('hidden'); }

  // ===== Setup UI Init =====
  const catSel = $("#categorySelect");
  Object.keys(PACKS).forEach(k=>{ const o=document.createElement('option'); o.value=k;o.textContent=k; catSel.appendChild(o);});

  $("#pairMode").addEventListener('change', e=>{
    $("#manualPairs").classList.toggle('hidden', e.target.value!=="manual");
  });

  $("#demoBtn").addEventListener('click', ()=>{
    $("#playersInput").value = 'ูุงุตุฑุ ุดูุฏุ ููุตูุ ุฑููุ ููุณู';
  });

  $("#startBtn").addEventListener('click', ()=>{
    const raw = $("#playersInput").value.trim();
    const names = raw.split(/[ุ,]/).map(s=>s.trim()).filter(Boolean);
    if(names.length < 3){ alert('ูุงุฒู 3 ูุงุนุจูู ุนูู ุงูุฃูู โ'); return; }

    state.players = names;
    $("#questionCount").value && (state.maxQuestions = parseInt($("#questionCount").value,10));

    state.category = $("#categorySelect").value;

    let base, odd;
    if($("#pairMode").value === 'manual'){
      base = $("#baseWord").value.trim();
      odd = $("#oddWord").value.trim();
      if(!base || !odd){ alert('ุงููุฃ ุงููููุชูู ูู ูุถูู'); return; }
    } else {
      const p = choice(PACKS[state.category]);
      [base, odd] = Math.random() < .5 ? p : [p[1], p[0]]; // ุนุดูุงุฆููุง ุจุฏูู
    }

    state.pair = {base, odd};
    state.oddIndex = Math.floor(Math.random()*state.players.length);
    state.reveals = {}; state.turnOrder = shuffle([...state.players]);
    state.asked = 0; state.usedQuestions = new Set(); state.votes = {};

    // Init scores if needed
    loadScores();
    state.players.forEach(n=>{ if(!(n in state.scores)) state.scores[n]=0; });
    renderScores();

    buildRevealList();
    setView('#view-reveal');
  });

  $("#backToSetup").addEventListener('click', ()=> setView('#view-setup'));

  function buildRevealList(){
    const box = $("#revealList"); box.innerHTML='';
    state.players.forEach((name, idx)=>{
      const item = el('div','card'); item.style.background='#101625'; item.style.borderColor='#1e2636';
      const b = el('button'); b.textContent = `๐๏ธโ๐จ๏ธ ${name} โ ุงุถุบุท ูุนุฑุถ ุงููููุฉ`;
      b.addEventListener('click', ()=>showWord(name, idx, b, item));
      item.appendChild(b);
      box.appendChild(item);
    });
  }

  function showWord(name, idx, btn, item){
    const isOdd = idx === state.oddIndex;
    const word = isOdd ? state.pair.odd : state.pair.base;
    btn.disabled = true; btn.classList.add('secondary');
    const w = el('div','word-flash center', word);
    const note = el('div','muted center', 'ุณูุฎุชูู ุฎูุงู 3 ุซูุงูู');
    item.appendChild(w); item.appendChild(note);
    setTimeout(()=>{ w.remove(); note.remove(); btn.textContent = `โ ${name} โ ุชูุช ุงููุดุงูุฏุฉ`; }, 3000);
    state.reveals[name] = true;
  }

  $("#beginQuestions").addEventListener('click', ()=>{
    // Ensure all saw their word (optional)
    const unseen = state.players.filter(n=>!state.reveals[n]);
    if(unseen.length){ if(!confirm('ุจุนุถ ุงููุงุนุจูู ูุง ุดุงููุง ูููุชูู. ุชุจุฏุฃ ุนูู ุฃู ุญุงูุ')) return; }
    $("#currentCategory").textContent = state.category;
    updateQuestionUI();
    setView('#view-questions');
  });

  function updateQuestionUI(){
    $("#qProgress").textContent = `${state.asked}/${state.maxQuestions}`;
    const q = nextQuestion();
    $("#questionText").textContent = q;
    const turn = state.turnOrder[state.asked % state.players.length];
    $("#turnName").textContent = turn;
  }

  function nextQuestion(){
    let q;
    const available = QUESTIONS.filter(x=>!state.usedQuestions.has(x));
    if(!available.length){ state.usedQuestions.clear(); }
    do { q = choice(QUESTIONS); } while(state.usedQuestions.has(q));
    state.usedQuestions.add(q);
    return q;
  }

  $("#nextQuestion").addEventListener('click', ()=>{
    if(state.asked+1 >= state.maxQuestions){ alert('ุจูุบุช ุญุฏ ุงูุฃุณุฆูุฉ ููุฐู ุงูุฌููุฉ. ุงูุชูู ููุชุตููุช.'); return; }
    state.asked++;
    // Randomize next turn order slightly
    if(Math.random()<0.4) state.turnOrder = shuffle(state.turnOrder);
    updateQuestionUI();
  });

  $("#goVote").addEventListener('click', ()=>{
    buildVoteUI();
    setView('#view-vote');
  });

  $("#backToQuestions").addEventListener('click', ()=> setView('#view-questions'));

  function buildVoteUI(){
    const area = $("#voteArea"); area.innerHTML='';
    state.votes = {};
    state.players.forEach(voter=>{
      const row = el('div','vote-item');
      const sel = document.createElement('select');
      sel.innerHTML = `<option value="">ุงุฎุชุฑ ุงููุดููู</option>` + state.players.map((p,i)=>`<option value="${i}" ${p===voter?'disabled':''}>${p}</option>`).join('');
      sel.addEventListener('change', ()=>{ state.votes[voter] = parseInt(sel.value,10); });
      row.appendChild(el('div',null,`<span class="badge">${voter}</span>`));
      row.appendChild(sel);
      area.appendChild(row);
    });
  }

  $("#submitVotes").addEventListener('click', ()=>{
    // Ensure all voted
    const missing = state.players.filter(p=>!(p in state.votes));
    if(missing.length){ alert('ูุณู ูุง ุตููุช ุงูุฌููุน.'); return; }

    // Count votes
    const tally = new Array(state.players.length).fill(0);
    Object.values(state.votes).forEach(idx=>{ if(Number.isInteger(idx)) tally[idx]++; });

    const most = Math.max(...tally);
    const suspects = tally.map((c,i)=>[c,i]).filter(([c])=>c===most).map(([,i])=>i);

    const caught = suspects.includes(state.oddIndex); // ูู ุชู ุงูุฅูุณุงู ุจุงููุฎุชููุ

    // Scoring
    // odd wins +3 if not caught, else 0; correct voters +1; wrong -1
    const oddName = state.players[state.oddIndex];
    if(caught){
      state.scores[oddName] += 0;
    } else {
      state.scores[oddName] += 3;
    }

    for(const [voter, idx] of Object.entries(state.votes)){
      if(idx === state.oddIndex && caught){ state.scores[voter] += 1; }
      else if(idx !== state.oddIndex){ state.scores[voter] -= 1; }
    }

    saveScores(); renderScores();
    showResult(tally, suspects, caught);
    setView('#view-result');
  });

  function showResult(tally, suspects, caught){
    const box = $("#resultSummary"); box.innerHTML='';
    const oddName = state.players[state.oddIndex];

    const a = el('div','card', `
      <div class="big">ุงููุฎุชูู ูุงู: <strong>${oddName}</strong></div>
      <div class="muted">ูููุฉ ุงูุฃุบูุจูุฉ: <span class="badge">${state.pair.base}</span></div>
      <div class="muted">ูููุฉ ุงููุฎุชูู: <span class="badge">${state.pair.odd}</span></div>
      <div class="hr"></div>
      <div>${caught ? '๐ ุชู ูุดู ุงููุฎุชูู โ ููุทุฉ (+1) ููู ูู ุตููุช ุนููู ุจุดูู ุตุญูุญ' : '๐ ูุง ุฃุญุฏ ูุดู ุงููุฎุชูู โ ูุญุตู ุนูู (+3) ููุงุท'}</div>
    `);

    const b = el('div','card');
    b.innerHTML = `<h3>ุชูุงุตูู ุงูุชุตููุช</h3>`;
    const ul = el('div','stack');
    state.players.forEach((p,i)=>{
      const voters = Object.entries(state.votes).filter(([,idx])=>idx===i).map(([name])=>name);
      ul.appendChild(el('div',null,`<span class="badge">${p}</span> โ ${tally[i]} ุตูุช${tally[i]!==1?'': ''} ${voters.length?`<span class="muted">(${voters.join('ุ ')})</span>`:''}`));
    });
    b.appendChild(ul);

    const c = el('div','card');
    c.innerHTML = `<h3>ุงูุชุฑุชูุจ ุงูุญุงูู</h3>`;
    const rank = el('div','stack');
    Object.entries(state.scores).sort((a,b)=>b[1]-a[1]).forEach(([n,s])=>{
      rank.appendChild(el('div','score',`<strong>${n}</strong><span>${s} ููุทุฉ</span>`));
    });
    c.appendChild(rank);

    box.appendChild(a); box.appendChild(b); box.appendChild(c);
  }

  $("#newRoundSame").addEventListener('click', ()=>{
    // keep players & scores, reset round
    state.category = $("#categorySelect").value;
    const p = choice(PACKS[state.category]);
    const [base, odd] = Math.random()<.5? p : [p[1], p[0]];
    state.pair = {base, odd};
    state.oddIndex = Math.floor(Math.random()*state.players.length);
    state.reveals = {}; state.turnOrder = shuffle([...state.players]);
    state.asked = 0; state.usedQuestions = new Set(); state.votes = {};
    buildRevealList();
    setView('#view-reveal');
  });

  $("#newRoundReset").addEventListener('click', ()=>{
    setView('#view-setup');
  });

  // initial
  loadScores(); renderScores();
  </script></body>
</html>
